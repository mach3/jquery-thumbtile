/*!
 * ThumbTile.js
 * ------------
 * Arrange images as tiles
 * 
 * @version 0.8.0
 * @url http://github.com/mach3/thumbtile.js
 * @license MIT License
 * @author mach3 <http://github.com/mach3>
 */
!function(){var a=function(){this.initialize.apply(this,arguments)};$.extend(a.prototype,{options:{gutter:10,base:150,rows:null,timeout:null,data:{}},el:null,$el:null,items:[],count:0,initialize:function(a,b,c){return this.el=a,this.$el=$(a),this.count=b.length,this.config(c),this.load(b).then($.proxy(this.render,this)),this},config:function(a){return this.options=$.extend(!0,{},this.options,a),this},load:function(a){var b,c=this;return b=$.Deferred(),$.each(a,function(a,d){var e={src:d.src,index:a,el:new Image,data:d.data||{}};e.el.onload=function(){c.count--,c.count||b.resolve()},e.el.src=d.src,c.items.push(e)}),this.options.timeout&&setTimeout(function(){b.resolve()},this.options.timeout),b},render:function(){var a,b,c,d,e=this;return b=this.$el.width(),a=0,d=0,c=[],this.$el.html(""),$.each(this.items,function(f,g){var h,i;if(g.el.complete===!0||"complete"===g.el.readyState){if(h=c[d]=c[d]||[],i=e.resize(g.el.width,g.el.height),h.push(g),g.width=i.width,g.height=i.height,a+=g.width,a>b){var j=(b-e.options.gutter*(h.length-1))/a;$.each(h,function(a,b){var c,f;c=a===h.length-1,f=$("<img>",{src:b.src}).css({width:b.width*j,height:b.height*j,"float":"left","margin-right":c?0:e.options.gutter,"margin-top":d?e.options.gutter:0}).data(b.data).appendTo(e.el)}),d++,a=0}return e.options.rows&&d>=e.options.rows?!1:void 0}}),this},resize:function(a,b,c){return c=c||this.base,{height:this.options.base,width:parseInt(a*(this.options.base/b),10)}}}),$.fn.thumbTile=function(b,c){var d,e;return d="thumbTileInstance",e=this.data(d),!arguments.length&&e instanceof a?e.render():b&&(e=new a(this.get(0),b,c),this.data(d,e)),this}}();